<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestionnaire de TÃ¢ches AvancÃ©</title>
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Header avec titre et contrÃ´les principaux -->
        <header class="header">
            <h1>ğŸ¯ Gestionnaire de TÃ¢ches</h1>
            <div class="header-controls">
                <button id="themeBtn" class="btn btn-icon" title="Changer le thÃ¨me">ğŸ¨</button>
                <button id="contactsBtn" class="btn btn-icon" title="Contacts">ğŸ‘¤</button>
                <button id="exportBtn" class="btn btn-primary" title="Exporter les donnÃ©es">ğŸ’¾ Exporter</button>
                <button id="importBtn" class="btn btn-secondary" title="Importer des donnÃ©es">ğŸ“¤ Importer</button>
            </div>
        </header>

        <!-- Barre de recherche et filtres -->
        <div class="search-filter-section">
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="ğŸ” Rechercher une tÃ¢che...">
            </div>
            <div class="filters">
                <select id="filterCategory">
                    <option value="">Toutes les catÃ©gories</option>
                </select>
                <select id="filterStatus">
                    <option value="">Tous les statuts</option>
                    <option value="todo">Ã€ faire</option>
                    <option value="inprogress">En cours</option>
                    <option value="done">TerminÃ©</option>
                    <option value="review">Ã€ revoir</option>
                </select>
                <select id="filterPriority">
                    <option value="">Toutes les prioritÃ©s</option>
                    <option value="low">Basse</option>
                    <option value="medium">Moyenne</option>
                    <option value="high">Haute</option>
                    <option value="urgent">Urgente</option>
                </select>
                <select id="filterPerson">
                    <option value="">Toutes les personnes</option>
                </select>
                <input type="date" id="filterDate" title="Filtrer par date">
                <select id="sortBy">
                    <option value="">Trier par...</option>
                    <option value="name">Nom (A-Z)</option>
                    <option value="date-asc">Date (+ proche)</option>
                    <option value="date-desc">Date (+ loin)</option>
                    <option value="priority">PrioritÃ©</option>
                    <option value="status">Statut</option>
                    <option value="category">CatÃ©gorie</option>
                </select>
            </div>
        </div>

        <!-- Navigation entre les vues -->
        <div class="view-tabs">
            <button class="tab-btn active" data-view="kanban">ğŸ“Š Kanban</button>
            <button class="tab-btn" data-view="list">ğŸ“‹ Liste</button>
            <button class="tab-btn" data-view="calendar">ğŸ“… Calendrier</button>
            <button class="tab-btn" data-view="dashboard">ğŸ“ˆ Tableau de bord</button>
            <button class="tab-btn" data-view="notes">ğŸ“ Note du jour</button>
            <button class="tab-btn" data-view="archive">ğŸ“¦ Archives</button>
        </div>

        <!-- Boutons d'action -->
        <div class="action-buttons">
            <button id="addTaskBtn" class="btn btn-primary">â• Ajouter une tÃ¢che</button>
            <button id="addCategoryBtn" class="btn btn-secondary">ğŸ“ Nouvelle catÃ©gorie</button>
            <button id="generateWeeklyReport" class="btn btn-report">ğŸ“Š Rapport hebdomadaire</button>
            <button id="generateMonthlyReport" class="btn btn-report">ğŸ“ˆ Rapport mensuel</button>
        </div>

        <!-- Vue Kanban -->
        <div id="kanbanView" class="view-content active">
            <div class="kanban-board" id="kanbanBoard">
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h3>Ã€ faire</h3>
                        <span class="task-count">0</span>
                    </div>
                    <div class="column-tasks" id="todoTasks"></div>
                </div>
                <div class="kanban-column" data-status="inprogress">
                    <div class="column-header">
                        <h3>En cours</h3>
                        <span class="task-count">0</span>
                    </div>
                    <div class="column-tasks" id="inprogressTasks"></div>
                </div>
                <div class="kanban-column" data-status="done">
                    <div class="column-header">
                        <h3>TerminÃ©</h3>
                        <span class="task-count">0</span>
                    </div>
                    <div class="column-tasks" id="doneTasks"></div>
                </div>
                <div class="kanban-column" data-status="review">
                    <div class="column-header">
                        <h3>Ã€ revoir</h3>
                        <span class="task-count">0</span>
                    </div>
                    <div class="column-tasks" id="reviewTasks"></div>
                </div>
            </div>
        </div>

        <!-- Vue Liste -->
        <div id="listView" class="view-content">
            <div id="listContainer"></div>
        </div>

        <!-- Vue Calendrier -->
        <div id="calendarView" class="view-content">
            <div class="calendar-controls">
                <button id="prevMonth" class="btn btn-icon">â—€</button>
                <h2 id="currentMonth"></h2>
                <button id="nextMonth" class="btn btn-icon">â–¶</button>
            </div>
            <div id="calendarGrid" class="calendar-grid"></div>
        </div>

        <!-- Vue Tableau de bord -->
        <div id="dashboardView" class="view-content">
            <div class="dashboard-stats">
                <div class="stat-card">
                    <h3>Total des tÃ¢ches</h3>
                    <div class="stat-value" id="totalTasks">0</div>
                </div>
                <div class="stat-card">
                    <h3>TÃ¢ches terminÃ©es</h3>
                    <div class="stat-value" id="completedTasks">0</div>
                </div>
                <div class="stat-card">
                    <h3>TÃ¢ches en cours</h3>
                    <div class="stat-value" id="activeTasks">0</div>
                </div>
                <div class="stat-card">
                    <h3>Taux d'achÃ¨vement</h3>
                    <div class="stat-value" id="completionRate">0%</div>
                </div>
            </div>
            <div class="dashboard-charts">
                <div class="chart-container">
                    <h3>TÃ¢ches par catÃ©gorie</h3>
                    <div id="categoryChart" class="chart"></div>
                </div>
                <div class="chart-container">
                    <h3>TÃ¢ches par prioritÃ©</h3>
                    <div id="priorityChart" class="chart"></div>
                </div>
                <div class="chart-container">
                    <h3>TÃ¢ches par statut</h3>
                    <div id="statusChart" class="chart"></div>
                </div>
            </div>
        </div>

        <!-- Vue Note du jour -->
        <div id="notesView" class="view-content">
            <div class="notes-header">
                <h2>ğŸ“ Note du jour - <span id="currentNoteDate"></span></h2>
                <div style="display:flex;gap:10px;margin-top:10px;">
                    <button id="prevDayBtn" class="btn btn-icon" title="Jour prÃ©cÃ©dent">â—€</button>
                    <button id="todayBtn" class="btn btn-secondary">Aujourd'hui</button>
                    <button id="nextDayBtn" class="btn btn-icon" title="Jour suivant">â–¶</button>
                </div>
            </div>
            <div class="notes-content">
                <textarea id="dailyNoteInput" placeholder="Que s'est-il passÃ© aujourd'hui ?" rows="15"></textarea>
                <div style="margin-top:10px;color:var(--text-secondary);font-size:0.9em;" id="noteStatus">
                    ğŸ’¡ Vos notes sont sauvegardÃ©es automatiquement
                </div>
            </div>
            <div class="notes-history">
                <h3>ğŸ“š Historique des notes</h3>
                <div id="notesHistoryList"></div>
            </div>
        </div>

        <!-- Vue Archives -->
        <div id="archiveView" class="view-content">
            <div class="archive-controls" style="margin-bottom:20px;">
                <h2>ğŸ“¦ TÃ¢ches archivÃ©es</h2>
                <p style="color:var(--text-secondary)">TÃ¢ches terminÃ©es archivÃ©es automatiquement aprÃ¨s 30 jours</p>
            </div>
            <div id="archiveContainer"></div>
        </div>
    </div>

    <!-- Modal d'ajout/modification de tÃ¢che -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Ajouter une tÃ¢che</h2>
                <button class="close-btn" id="closeTaskModal">&times;</button>
            </div>
            <form id="taskForm">
                <div class="form-group">
                    <label for="taskName">Nom de la tÃ¢che *</label>
                    <input type="text" id="taskName" required>
                </div>
                <div class="form-group">
                    <label for="taskDescription">Description</label>
                    <textarea id="taskDescription" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskDate">Date d'Ã©chÃ©ance *</label>
                        <input type="date" id="taskDate" required>
                    </div>
                    <div class="form-group">
                        <label for="taskCategory">CatÃ©gorie *</label>
                        <select id="taskCategory" required></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskStatus">Statut *</label>
                        <select id="taskStatus" required>
                            <option value="todo">Ã€ faire</option>
                            <option value="inprogress">En cours</option>
                            <option value="done">TerminÃ©</option>
                            <option value="review">Ã€ revoir</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">PrioritÃ© *</label>
                        <select id="taskPriority" required>
                            <option value="low">Basse</option>
                            <option value="medium">Moyenne</option>
                            <option value="high">Haute</option>
                            <option value="urgent">Urgente</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="taskAssignees">Personnes assignÃ©es</label>
                    <select id="taskAssignees" multiple style="height:120px;"></select>
                </div>
                <div class="form-group">
                    <label for="taskRecurrence">RÃ©currence</label>
                    <select id="taskRecurrence">
                        <option value="">Aucune</option>
                        <option value="daily">Quotidienne</option>
                        <option value="weekly">Hebdomadaire</option>
                        <option value="monthly">Mensuelle</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskReminders">Rappels (minutes avant Ã©chÃ©ance)</label>
                    <input type="text" id="taskReminders" placeholder="Ex: 60, 1440 (1 jour)">
                    <small style="color:var(--text-secondary)">SÃ©parez par des virgules (ex: 30, 60, 1440)</small>
                </div>
                <div class="form-group">
                    <label for="taskDependencies">DÃ©pend de (tÃ¢ches Ã  terminer avant)</label>
                    <select id="taskDependencies" multiple style="height:100px;"></select>
                </div>
                <div class="form-group">
                    <label for="taskAttachments">ğŸ“ PiÃ¨ces jointes</label>
                    <input type="file" id="taskAttachments" multiple accept="*/*">
                    <div id="attachmentsList" style="margin-top:10px;"></div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelTaskBtn">Annuler</button>
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                </div>
            </form>
            <div id="taskComments" class="task-comments" style="display: none;">
                <h3>ğŸ’¬ Commentaires</h3>
                <div id="commentsList"></div>
                <form id="commentForm" style="margin-top:15px;">
                    <textarea id="commentInput" rows="2" placeholder="Ajouter un commentaire..." style="width:100%;padding:10px;border:2px solid var(--border-color);border-radius:8px;"></textarea>
                    <button type="submit" class="btn btn-primary" style="margin-top:8px;">Publier</button>
                </form>
            </div>
            <div id="taskHistory" class="task-history" style="display: none;">
                <h3>Journal des modifications</h3>
                <div id="historyList"></div>
            </div>
        </div>
    </div>

    <!-- Modal d'ajout de catÃ©gorie -->
    <div id="categoryModal" class="modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h2 id="categoryModalTitle">Nouvelle catÃ©gorie</h2>
                <button class="close-btn" id="closeCategoryModal">&times;</button>
            </div>
            <form id="categoryForm">
                <div class="form-group">
                    <label for="categoryName">Nom de la catÃ©gorie *</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label for="categoryColor">Couleur</label>
                    <input type="color" id="categoryColor" value="#3498db">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCategoryBtn">Annuler</button>
                    <button type="submit" class="btn btn-primary">CrÃ©er</button>
                </div>
            </form>
            <div style="margin-top:25px;border-top:2px solid var(--border-color);padding-top:20px;">
                <h3>ğŸ“ CatÃ©gories existantes</h3>
                <div id="categoriesList" style="margin-top:15px;"></div>
            </div>
        </div>
    </div>

    <!-- Modal d'exportation -->
    <div id="exportModal" class="modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h2>Exporter les tÃ¢ches</h2>
                <button class="close-btn" id="closeExportModal">&times;</button>
            </div>
            <div class="export-options">
                <button class="btn btn-primary export-btn" data-format="csv">ğŸ“„ Exporter en CSV</button>
                <button class="btn btn-primary export-btn" data-format="json">ğŸ“‹ Exporter en JSON</button>
                <button class="btn btn-primary export-btn" data-format="pdf">ğŸ“• Exporter en PDF</button>
            </div>
        </div>
    </div>

    <!-- Modal d'importation -->
    <div id="importModal" class="modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h2>Importer des tÃ¢ches</h2>
                <button class="close-btn" id="closeImportModal">&times;</button>
            </div>
            <div class="import-body">
                <p>SÃ©lectionnez un fichier JSON ou CSV exportÃ© prÃ©cÃ©demment pour restaurer ou ajouter des tÃ¢ches.</p>
                <div class="file-input-wrapper">
                    <input type="file" id="importFileInput" accept=".json,.csv">
                    <label for="importFileInput" class="file-input-label">
                        <span class="file-icon">ğŸ“</span>
                        <span>Cliquez pour parcourir ou glissez un fichier</span>
                    </label>
                    <div id="fileNameDisplay" class="file-name-display"></div>
                </div>
                <div style="margin-top:15px;display:flex;gap:10px;justify-content:flex-end;">
                    <button class="btn btn-secondary" id="cancelImportBtn">Annuler</button>
                    <button class="btn btn-primary" id="confirmImportBtn">Importer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Contacts -->
    <div id="contactsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Contacts / Personnes</h2>
                <button class="close-btn" id="closeContactsModal">&times;</button>
            </div>
            <div class="contacts-body">
                <form id="contactForm">
                    <div class="form-group">
                        <label for="contactName">Nom *</label>
                        <input type="text" id="contactName" required>
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">Email</label>
                        <input type="email" id="contactEmail">
                    </div>
                    <div class="form-group">
                        <label for="contactColor">Couleur</label>
                        <input type="color" id="contactColor" value="#8e44ad">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelContactBtn">Annuler</button>
                        <button type="submit" class="btn btn-primary">Ajouter</button>
                    </div>
                </form>
                <div style="margin-top:20px;">
                    <h3>Liste des contacts</h3>
                    <div id="contactsList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de thÃ¨me -->
    <div id="themeModal" class="modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h2>Personnalisation</h2>
                <button class="close-btn" id="closeThemeModal">&times;</button>
            </div>
            <div class="theme-options">
                <h3>ThÃ¨mes prÃ©dÃ©finis</h3>
                <div class="theme-presets">
                    <button class="theme-btn" data-theme="light">â˜€ï¸ Clair</button>
                    <button class="theme-btn" data-theme="dark">ğŸŒ™ Sombre</button>
                    <button class="theme-btn" data-theme="blue">ğŸ’™ Bleu</button>
                    <button class="theme-btn" data-theme="green">ğŸ’š Vert</button>
                    <button class="theme-btn" data-theme="purple">ğŸ’œ Violet</button>
                </div>
                <h3>Couleurs personnalisÃ©es</h3>
                <div class="color-customization">
                    <div class="form-group">
                        <label for="primaryColor">Couleur principale</label>
                        <input type="color" id="primaryColor" value="#3498db">
                    </div>
                    <div class="form-group">
                        <label for="backgroundColor">Couleur de fond</label>
                        <input type="color" id="backgroundColor" value="#f5f7fa">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <!-- jsPDF pour l'export PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Marked.js pour le rendu Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</body>
</html>
